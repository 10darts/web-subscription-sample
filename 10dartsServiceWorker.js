!function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=32)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.navigatorLanguage=t.urlB64ToUint8Array=t.getCodeFromUrl=t.userAgent=t.patch=t.post=t.get=t.logger=t.clear=t.store=void 0;var o=r(4),i=n(o),u=r(13),a=n(u),c=r(14),s=n(c),l=r(15),f=r(16),d=r(17),v=n(d);t.store=i.default,t.clear=v.default,t.logger=a.default,t.get=l.get,t.post=l.post,t.patch=l.patch,t.userAgent=f.userAgent,t.getCodeFromUrl=f.getCodeFromUrl,t.urlB64ToUint8Array=f.urlB64ToUint8Array,t.navigatorLanguage=s.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(t.DEVICE="_10darts_device",t.LAST_ACCESS="_10darts_last_access",t.SERVER_URL="https://10darts.com");t.URL_API=n+"/api/v1",t.URL_API_V1=n+"/api/v1",t.CREATE_DEVICE_EVENT="CREATE_DEVICE_EVENT"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registration=void 0;var n=r(19),o=function(e){return e&&e.__esModule?e:{default:e}}(n);t.registration=o.default},function(e,t,r){"use strict";function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.store.device;if(o.store.geolocation&&"geolocation"in navigator){if(!e)throw new Error("You need a device code to send geolocation");(0,o.logger)("Getting geolocation"),navigator.geolocation.getCurrentPosition(function(t){var r=t.coords;(0,o.logger)("Geolocation",r);var n={type:"Point",coordinates:[r.longitude,r.latitude]},i="/devices/"+e+"/";(0,o.patch)(i,{position:n}).then(function(){return(0,o.logger)("Position saved")})})}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var o=r(0)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=r(1),i=function(){var e={device:"undefined"!=typeof localStorage?localStorage.getItem(o.DEVICE):null,lastAccess:"undefined"!=typeof localStorage?localStorage.getItem(o.LAST_ACCESS):null,token:null,publicKey:null,autosubscribe:!1,geolocation:!1,debug:!1,key:null};return{setState:function(t){e=n({},e,t)},getState:function(){return e},get geolocation(){return e.geolocation},get debug(){return e.debug},set token(t){if(!t)throw new Error("Token is required");e.token=t},get token(){return e.token},set publicKey(t){if(!t)throw new Error("Public key is required");e.publicKey=t},get publicKey(){return e.publicKey},set device(t){e.device=t,null===t||void 0===t?localStorage.removeItem(o.DEVICE):localStorage.setItem(o.DEVICE,t)},get device(){return e.device},set lastAccess(t){e.lastAccess=t,null===t||void 0===t?localStorage.removeItem(o.LAST_ACCESS):localStorage.setItem(o.LAST_ACCESS,t)},get lastAccess(){return e.lastAccess},get key(){return e.key},set key(t){if("string"==typeof t)e.key={label:t};else{if(!t.label||!t.value)throw new Error("key value need a label and value");e.key=t}}}}();t.default=i},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.subscriptionToServer=t.received=t.follow=t.unsubscribe=t.subscribe=void 0;var o=r(18),i=n(o),u=r(27),a=n(u),c=r(11),s=n(c),l=r(12),f=n(l),d=r(10),v=n(d);t.subscribe=i.default,t.unsubscribe=a.default,t.follow=s.default,t.received=f.default,t.subscriptionToServer=v.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.linkClientData=t.geolocation=t.saveKey=t.access=t.create=void 0;var o=r(20),i=n(o),u=r(25),a=n(u),c=r(3),s=n(c),l=r(26),f=n(l),d=r(9),v=n(d);t.create=i.default,t.access=a.default,t.saveKey=v.default,t.geolocation=s.default,t.linkClientData=f.default},function(e,t){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function n(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}e.exports=function(e){return null!=e&&(r(e)||n(e)||!!e._isBuffer)}},function(e,t,r){"use strict";function n(e){var t=e.toJSON();return{endpoint:t.endpoint,p256dh:t.keys.p256dh,auth:t.keys.auth}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,r){"use strict";function n(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n={device:"/api/v1/devices/"+o.store.device+"/",key:{label:e}};return t&&(n.value=t,n.kind=r),(0,o.post)("/keys/devices/",n).then(function(){(0,o.logger)("Key saved: ",e)})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var o=r(0)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.store.device,r="/api/v1/devices/"+t+"/",o=(0,i.default)(e),a=n({device:r},o);return(0,u.post)("/platforms/web/subscriptions/",a).then(function(){return(0,u.logger)("Subscription saved")})};var o=r(8),i=function(e){return e&&e.__esModule?e:{default:e}}(o),u=r(0)},function(e,t,r){"use strict";function n(e,t,r){var n="/pushes/"+e+"/follow/",i="/api/v1/devices/"+t+"/";return(0,o.post)(n,{device:i},r).then(function(e){return(0,o.logger)("follow",e.status)})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var o=r(0)},function(e,t,r){"use strict";function n(e,t,r){var n="/pushes/"+e+"/received/",i="/api/v1/devices/"+t+"/";return(0,o.post)(n,{device:i},r).then(function(e){return(0,o.logger)("received",e.status)})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var o=r(0)},function(e,t,r){"use strict";function n(){if(o.store.debug){var e;(e=console).log.apply(e,arguments)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var o=r(0)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return(navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage).toLowerCase().split(/[_-]+/)[0]}},function(e,t,r){"use strict";function n(e){return{Authorization:"AppToken "+e,"Content-Type":"application/json"}}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.default.token,r=n(t);return fetch(""+s.URL_API_V1+e,{method:"GET",headers:r})}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c.default.token,o=n(r);return fetch(""+s.URL_API_V1+e,{method:"POST",headers:o,body:JSON.stringify(t)})}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c.default.token,o=n(r);return fetch(""+s.URL_API_V1+e,{method:"PATCH",headers:o,body:JSON.stringify(t)})}Object.defineProperty(t,"__esModule",{value:!0}),t.get=o,t.post=i,t.patch=u;var a=r(4),c=function(e){return e&&e.__esModule?e:{default:e}}(a),s=r(1)},function(e,t,r){"use strict";function n(){return navigator?navigator.userAgent:null}function o(e){try{return e.match(/([^\/]*)\/*$/)[1]}catch(e){return null}}function i(e){for(var t="=".repeat((4-e.length%4)%4),r=(e+t).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(r),o=new Uint8Array(n.length),i=0;i<n.length;i+=1)o[i]=n.charCodeAt(i);return o}Object.defineProperty(t,"__esModule",{value:!0}),t.userAgent=n,t.getCodeFromUrl=o,t.urlB64ToUint8Array=i},function(e,t,r){"use strict";function n(){(0,o.unsubscribe)(),i.store.device=null,i.store.lastAccess=null}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var o=r(5),i=r(0)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){(0,n.registration)().then(function(e){e.pushManager.getSubscription().then(function(t){if(t)(0,a.logger)("Push subscription exists"),a.store.device||(0,o.create)(t).then(function(){return(0,a.logger)("Subscription saved")});else{(0,a.logger)("Getting subscription");var r=(0,a.urlB64ToUint8Array)(a.store.publicKey);e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:r}).then(function(e){(0,a.logger)("Push subscription",e),a.store.device?(0,u.default)(e):(0,o.create)(e).then(function(){return(0,a.logger)("Subscription saved")})})}}).catch(function(e){return(0,a.logger)("Failed to subscribe the user: ",e)})})};var n=r(2),o=r(6),i=r(10),u=function(e){return e&&e.__esModule?e:{default:e}}(i),a=r(0)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return new Promise(function(e,t){"serviceWorker"in navigator&&"PushManager"in window?((0,n.logger)("Sevice Worker and Push is supported"),navigator.serviceWorker.register("/10dartsServiceWorker.js",{scope:o}).then(function(t){(0,n.logger)("Service Worker is registered",t),e(t)}).catch(function(e){return(0,n.logger)("Service Worker Error",e)})):t(new Error("Push messaging is not supported"))})};var n=r(0),o="/"},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!e)throw new Error("You need a subscription to create device");var r=(0,a.default)(e),n=(0,v.userAgent)(),o=(0,v.navigatorLanguage)(),u={platform:"web",token:(0,i.default)("*",30),model:n,language:o,web_subscription:r};return t&&(u.position={type:"Point",coordinates:[t.coords.latitude,t.coords.longitude]}),(0,v.post)("/devices/",u).then(function(e){if(e.ok)return e.json();throw e}).then(function(e){var t=e.code;if(v.store.device=t,v.store.lastAccess=Date.now(),document.dispatchEvent(new Event(d.CREATE_DEVICE_EVENT)),(0,s.default)(),v.store.key){var r=v.store.key,n=r.label,o=r.value,i=r.kind;(0,f.default)(n,o,i)}}).catch(function(e){if(400===e.status)return e.json().then(function(e){return Promise.reject(e)});throw e})};var o=r(21),i=n(o),u=r(8),a=n(u),c=r(3),s=n(c),l=r(9),f=n(l),d=r(1),v=r(0)},function(e,t,r){"use strict";function n(e,t,r){if(void 0===e)throw new Error("randomatic expects a string or number.");var n=!1;1===arguments.length&&("string"==typeof e?t=e.length:o(e)&&(r={},t=e,e="*")),"object"===i(t)&&t.hasOwnProperty("chars")&&(r=t,e=r.chars,t=e.length,n=!0);var a=r||{},c="",s="";for(-1!==e.indexOf("?")&&(c+=a.chars),-1!==e.indexOf("a")&&(c+=u.lower),-1!==e.indexOf("A")&&(c+=u.upper),-1!==e.indexOf("0")&&(c+=u.number),-1!==e.indexOf("!")&&(c+=u.special),-1!==e.indexOf("*")&&(c+=u.all),n&&(c+=e);t--;)s+=c.charAt(parseInt(Math.random()*c.length,10));return s}var o=r(22),i=r(24);e.exports=n;var u={lower:"abcdefghijklmnopqrstuvwxyz",upper:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",number:"0123456789",special:"~!@#$%^&()_+-={}[];',."};u.all=u.lower+u.upper+u.number+u.special},function(e,t,r){"use strict";var n=r(23);e.exports=function(e){var t=n(e);if("string"===t){if(!e.trim())return!1}else if("number"!==t)return!1;return e-e+1>=0}},function(e,t,r){var n=r(7),o=Object.prototype.toString;e.exports=function(e){if(void 0===e)return"undefined";if(null===e)return"null";if(!0===e||!1===e||e instanceof Boolean)return"boolean";if("string"==typeof e||e instanceof String)return"string";if("number"==typeof e||e instanceof Number)return"number";if("function"==typeof e||e instanceof Function)return"function";if(void 0!==Array.isArray&&Array.isArray(e))return"array";if(e instanceof RegExp)return"regexp";if(e instanceof Date)return"date";var t=o.call(e);return"[object RegExp]"===t?"regexp":"[object Date]"===t?"date":"[object Arguments]"===t?"arguments":"[object Error]"===t?"error":n(e)?"buffer":"[object Set]"===t?"set":"[object WeakSet]"===t?"weakset":"[object Map]"===t?"map":"[object WeakMap]"===t?"weakmap":"[object Symbol]"===t?"symbol":"[object Int8Array]"===t?"int8array":"[object Uint8Array]"===t?"uint8array":"[object Uint8ClampedArray]"===t?"uint8clampedarray":"[object Int16Array]"===t?"int16array":"[object Uint16Array]"===t?"uint16array":"[object Int32Array]"===t?"int32array":"[object Uint32Array]"===t?"uint32array":"[object Float32Array]"===t?"float32array":"[object Float64Array]"===t?"float64array":"object"}},function(e,t,r){var n=r(7),o=Object.prototype.toString;e.exports=function(e){if(void 0===e)return"undefined";if(null===e)return"null";if(!0===e||!1===e||e instanceof Boolean)return"boolean";if("string"==typeof e||e instanceof String)return"string";if("number"==typeof e||e instanceof Number)return"number";if("function"==typeof e||e instanceof Function)return"function";if(void 0!==Array.isArray&&Array.isArray(e))return"array";if(e instanceof RegExp)return"regexp";if(e instanceof Date)return"date";var t=o.call(e);return"[object RegExp]"===t?"regexp":"[object Date]"===t?"date":"[object Arguments]"===t?"arguments":"[object Error]"===t?"error":"[object Promise]"===t?"promise":n(e)?"buffer":"[object Set]"===t?"set":"[object WeakSet]"===t?"weakset":"[object Map]"===t?"map":"[object WeakMap]"===t?"weakmap":"[object Symbol]"===t?"symbol":"[object Int8Array]"===t?"int8array":"[object Uint8Array]"===t?"uint8array":"[object Uint8ClampedArray]"===t?"uint8clampedarray":"[object Int16Array]"===t?"int16array":"[object Uint16Array]"===t?"uint16array":"[object Int32Array]"===t?"int32array":"[object Uint32Array]"===t?"uint32array":"[object Float32Array]"===t?"float32array":"[object Float64Array]"===t?"float64array":"object"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=Date.now(),t=null!==i.store.device,r=i.store.lastAccess&&i.store.lastAccess<e-u;if(t&&r){var n="/devices/"+i.store.device+"/access/";(0,i.post)(n).then(function(){i.store.lastAccess=e,(0,i.logger)("Update last access")}),(0,o.default)()}};var n=r(3),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i=r(0),u=72e5},function(e,t,r){"use strict";function n(e){return(0,o.post)("/devices/links/",{device:"/api/v1/devices/"+o.store.device+"/",client_data:e}).catch(function(e){return(0,o.logger)(e)})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var o=r(0)},function(e,t,r){"use strict";function n(){(0,o.registration)().then(function(e){e.pushManager.getSubscription().then(function(e){return e?e.unsubscribe():null}).catch(function(e){return(0,i.logger)("Error unsubscribing",e)}).then(function(){(0,i.logger)("User is unsubscribed.")})})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var o=r(2),i=r(0)},,,,,function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){return Math.floor(1e3*Math.random())}function i(e){try{return e.json()}catch(e){return{}}}var u=r(12),a=n(u),c=r(11),s=n(c);self.addEventListener("push",function(e){console.log("[Service Worker] Push Received");var t=i(e.data),r=t.code,n=t.title,u=t.body,c=t.badge,s=t.icon,l=t.image,f=t.silent_push,d=t.confirmation_needed,v=t.url,g=t.device,b=t.token,p={body:u,icon:s,badge:c,image:l,data:{code:r,url:v,silentPush:f,confirmationNeeded:d,device:g,token:b}};if(d){var y=o();setTimeout(function(){return(0,a.default)(r,g,b)},y)}if(!f){var j=self.registration.showNotification(n,p);e.waitUntil(j)}}),self.addEventListener("notificationclick",function(e){console.log("[Service Worker] Notification click Received."),e.notification.close();var t=e.notification.data;(0,s.default)(t.code,t.device,t.token),t.url&&e.waitUntil(clients.openWindow(t.url))})}]);